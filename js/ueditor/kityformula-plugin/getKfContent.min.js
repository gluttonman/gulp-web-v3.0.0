UE.Editor.prototype.getKfContent=function(t){function e(){i>=s.length&&(r.sync(),t(r.getContent()))}var r=this,a=r.getActionUrl(r.getOpt("scrawlActionName")),n=UE.utils.serializeParam(r.queryCommandValue("serverparam"))||"",i=(UE.utils.formatUrl(a+(-1==a.indexOf("?")?"?":"&")+n),0),o=r.body.getElementsByTagName("img"),s=[];UE.utils.each(o,function(t){"data:image/png"===t.getAttribute("src").match(/^[^;]+/)[0]&&s.push(t)}),0==s.length?e():UE.utils.each(s,function(t){var a={};a[r.getOpt("scrawlFieldName")]=t.getAttribute("src").replace(/^[^,]+,/,""),a.onsuccess=function(r){var a=UE.utils.str2json(r.responseText),n=url_path_down+a.url;t.setAttribute("src",n),t.setAttribute("_src",n),i++,e()},a.onerror=function(t){console.error(t),i++,e()};var n=NewGuid(),o=r.getOpt("imageUrlPrefix")+n.substring(0,2)+"/",s=n+".png";a.pt_type=pt_type,a.upload_key=o,a.file_name=s;var u=url_path_action_login+"/uploadres/editorUpload";UE.ajax.request(u,a)})};
function loadTopicType(){$.ajax({type:"post",async:!1,data:{},url:url_path_html+"/yx/topic/topiclxList?r="+Math.random(),success:function(data){var dataObj=eval("("+data+")");dataObj=dataObj.list;for(var ul=$("#res_ul"),i=0;i<dataObj.length;i++){var li=$("<li></li>");li.attr("onclick","changeTopicType("+dataObj[i].lx_id+",this)");var a=$('<a style="cursor:pointer"></a>');a.text(dataObj[i].lx_name),li.append(a),ul.append(li)}}})}function changeTopicType(t,e){$("#bk_type").val(t),$(e).parent().find("a").removeClass("active"),$(e).find("a").addClass("active"),toPage(1)}function toPage(t){var e=$("#title").val(),a=$("#bk_type").val(),i=$("#sel_stage").val(),o=$("#sel_subject").val(),n={page:!0,title:Base64.encode(e),lx_id:a,org_id:unit_id,stage_id:i,subject_id:o,page_number:t,page_size:10},l=url_path_html+"/yx/topic/getManageTopicList?random="+Math.random();dataRender(n,l,"div_note","script_note")}function toEditTopic(t,e){var a="添加专题";t>0&&(a="修改专题");var i=url_path_html+"/yx/html/topic/editTopic.html?id="+t;art.dialog.open(i,{title:a,height:450,width:750,zIndex:9999,lock:!0,ok:function(){var a=this.iframe.contentWindow,i=a.$("#lx_id").find("option:selected").val(),o=a.$("#lx_id").find("option:selected").text(),n=a.$("#sel_stage").val(),l=a.$("#sel_subject").val(),c=a.$("#sel_stage").find("option:selected").text(),d=a.$("#sel_subject").find("option:selected").text(),s=a.$("#title").val();if(""==$.trim(s)||s.length>30)return art.dialog.alert("专题名称字数1-30！"),!1;var r=a.$("#content").val();if(r.length>300)return art.dialog.alert("专题导读0-300字符！"),!1;var u=url_path_html+"/yx/topic/save",p={id:t,lx_id:i,lx_name:o,stage_id:n,subject_id:l,stage_name:c,subject_name:d,org_id:parent.getHoleOrgId(),title:s,content:r,method:"add"};t>0&&(p.method="edit"),setTimeout(function(){art.dialog({content:"正在保存信息...",width:240,title:"提示",close:function(){return!0},init:function(){var a=this;$.ajax({type:"post",data:p,url:u,dataType:"json",success:function(i){if(!i.success)return a.close(),dialogClose("系统繁忙！",3,200,""),!0;setTimeout(function(){return dialogClose(0==t?"添加成功！":"修改成功！",3,200,""),a.close(),toPage(e),!0},200)}})}})},10)},cancel:function(){}})}function deleteTheTopic(t,e){art.dialog.confirm("确定要删除吗？",function(){var a=url_path_html+"/yx/topic/delete?t="+Math.random(),i={id:t};$.ajax({async:!0,url:a,type:"post",data:i,dataType:"json",success:function(t){t.success?dialogClose("删除成功！",1,200,"toPage("+e+")"):dialogClose("系统繁忙，请稍后再试！",1,200,"")}})})}function viewDetail(t){var e=parent.window.location+"";e=e.substring(0,e.lastIndexOf("/")),window.open(e+"/topic.html?id="+t)}function checkTopic(t,e,a){if(!t)return void console.error("id or recommend is null");art.dialog.confirm("确定要执行操作吗？",function(){var i=url_path_html+"/yx/topic/checkTopic?t="+Math.random(),o={topic_id:t,checkFlag:e,business_type:1};$.ajax({async:!0,url:i,type:"post",data:o,dataType:"json",success:function(t){t.success?dialogClose("操作成功！",1,200,"toPage("+a+")"):dialogClose("系统繁忙，请稍后再试！",1,200,"")}})})}$(document).ready(function(){loadTopicType(),getSel_stage_subject("sel_stage_subject"),changeOrg($.cookie("background_yx_manage_org_id"),$.cookie("background_yx_manage_org_name")),toPage(1),$(document).on("click","#use_help",function(){playHelp("35.mp4")})});
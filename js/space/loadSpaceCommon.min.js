!function(e){"use strict";var t=function(t,a){this.ele=t,this.personInfo={person_id:e.cookie("person_id")||"",identity_id:e.cookie("identity_id")||"",bperson_id:a.id,bidentity_id:a.identity_id,is_admin:a.is_admin||0,roles:[]},this.setting={topNav:{leftNav:["viewSpace","spacePortlet","layout","theme","open"],right:["select","message","person"]},body:!0,nav:!0,type:a.type?a.type:"",has_portlet:function(e){return[{"常用工具":[{id:"org_news",name:"新闻资讯",repetition:0},{id:"org_yxSelfInfo",name:"工作室简介",repetition:0},{id:"yx_workroomCount",name:"工作室统计",repetition:0},{id:"yx_workroom_article",name:"工作室文章",repetition:0},{id:"yx_workroom_resource",name:"工作室资源",repetition:0},{id:"yx_workroom_video",name:"工作室视频",repetition:0},{id:"yx_workroom_hd",name:"工作室活动",repetition:0},{id:"groupMember",name:"工作室成员",repetition:0},{id:"toplink",name:"快捷链接",repetition:0},{id:"photos",name:"工作室相册",repetition:0},{id:"messageBoard",name:"留言板",repetition:0}]}]}},this.path="/dsideal_yy",this.themeId,this.init(a),this.initBack(),this.initTopNav(),this.initNav(),this.spaceMessageArt=null,window.has_portlet=this.setting.has_portlet(this)};t.prototype.init=function(e){var t=!1;document.location.pathname.indexOf("/work.html")>0&&(t=!0),1==e.is_admin&&t||(this.setting.topNav={leftNav:["viewSpace"],right:["select","message","person"]})},t.prototype.initTopNav=function(){var t=this,a=t.setting.topNav;if(0!=window.openPage&&a)if(e(t.ele).find(".space_top_nav_back")[0]?e(t.ele).find(".space_top_nav").empty():e(t.ele).append("<div class='space_top_nav_back'></div><div class='space_top_nav'></div>"),t.personInfo.person_id){a=t.setting.topNav;for(var i in a)e(t.ele).find(".space_top_nav").append("<div class='"+i+"'></div>"),e(a[i]).each(function(){t[this](i)})}else t.setting.topNav={right:["select","login"]},e(t.ele).find(".space_top_nav").append("<div class='right'></div>"),t.select("right"),t.login("right")},t.prototype.initBack=function(){var t,a="",i=this,s=i.getThemeId(),n=group_data.GROUP_NAME;window.org_info_=window.org_info_?window.org_info_:{},org_info_.org_name=Base64.encode(n),org_info_.org_description_text=Base64.encode(group_data.GROUP_DESC),e("body").attr("themeVal",s),e("body").attr("themeType","person"),a+="<div class='spaceBackDiv'>",a+="<div class='name'>"+n+"</div>",a+="<div class='signature'></div>",a+="</div>",t=n,e(i.ele).append(a),t&&(document.title=t)},t.prototype.initNav=function(){var t=this,a="";if(t.setting.nav){a+="<div id='nav_space_maintop' class='spacebox-shadow'>",a+="<ul id='navul_space' class='clearfix'>",a+="<li class='outli nav_work'><a target='_self' href='"+t.path+"/yx/html/space/main/work.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>首页</a></li>",a+="<li class='outli nav_group_jyNews'><a target='_self' href='"+t.path+"/yx/html/space/main/group_jyNews.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>新闻资讯</a></li>",a+="<li class='outli nav_group_jyarticle'><a target='_self' href='"+t.path+"/yx/html/space/main/group_jyarticle.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>文章</a></li>",a+="<li class='outli nav_group_gallery'><a target='_self' href='"+t.path+"/yx/html/space/main/group_gallery.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>相册</a></li>",a+="<li class='outli nav_group_jyVideo'><a target='_self' href='"+t.path+"/yx/html/space/main/group_jyVideo.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>视频</a></li>",a+="<li class='outli nav_group_huodong'><a target='_self' href='"+t.path+"/yx/html/space/main/group_huodong.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>活动</a></li>",a+="<li class='outli nav_group_topic'><a target='_self' href='"+t.path+"/yx/html/space/main/group_topic.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>专题</a></li>",a+="<li class='outli nav_group_jyres'><a target='_self' href='"+t.path+"/yx/html/space/main/group_jyres.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>网盘</a></li>",a+="<li class='outli nav_group_jytl'><a target='_self' href='"+t.path+"/yx/html/space/main/group_jytl.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>讨论</a></li>",a+="<li class='outli nav_group_member'><a target='_self' href='"+t.path+"/yx/html/space/main/group_member.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>基本信息</a></li>",a+="<li class='outli nav_group_yx_score_sort'><a target='_self' href='"+t.path+"/yx/html/space/main/group_yx_score_sort.html?orgid="+t.personInfo.bperson_id+"&iid="+t.personInfo.bidentity_id+"'>积分排名</a></li>",e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),a_id:t.personInfo.bperson_id,a_identity_id:t.personInfo.bidentity_id,a_type:(t.personInfo.bidentity_id,"spacenav")},url:url_path_action_login+"/space/getAJson",dataType:"json",success:function(e){if(e.success)for(var t=e.a_json,i=0;i<t.length;i++)if(t[i].checked){a+="<li class='outli'>",a+="<a href="+Base64.decode(t[i].url)+" target='_blank'>"+Base64.decode(t[i].name)+"</a>";for(var s=0,n=0;s<t[i].list.length;s++)t[i].list[s].checked&&(0==n&&(a+="<ul>",n+=1),a+="<a href="+Base64.decode(t[i].list[s].url)+" target='_blank'><li>"+Base64.decode(t[i].list[s].name)+"</li></a>"),s==t[i].list.length-1&&1==n&&(a+="</ul>");a+="</li>"}}}),t.personInfo.person_id!=t.personInfo.bperson_id&&t.personInfo.identity_id!=t.personInfo.bidentity_id||(a+="<a class='setting' href='"+t.path+"/html/space/main/main_manage.html?menu_id=space_nav'></a>"),a+="</ul>",a+="</div>",e(t.ele).append(a),e("#navul_space > li").not(".navhome").hover(function(){e(this).addClass("navmoon")},function(){e(this).removeClass("navmoon")});var i=e("#navul_space").children("li"),s=e("#navul_space").width()-5;e(i).each(function(t){s-e(i[t]).outerWidth()<0&&e(i[t]).hide(),s-=e(i[t]).outerWidth()});var n=window.location.pathname;n=(n=n.substr(n.lastIndexOf("/")+1)).split(".")[0],e("#navul_space > li.nav_"+n).addClass("active")}},t.prototype.spacePortlet=function(t){var a="",i=this;a+="<div class='spacePortlet dropdown'><a id='showPortletDropdown' href='javascript:void(0);' class='dropdown-toggle' data-toggle='dropdown'>添加应用",a+="&nbsp;&nbsp;<span class='caret'></span></a>",a+="<div id='add_portlets_ul' class='dropdown-menu' role='menu'>",a+="<li><div><img class='closeImg' src='"+i.path+"/images/space/icon_chablue.png' title='关闭' width='14' height='24'/><ul id='tree_portletslist' class='ztree'></ul></div></li>",a+="</div>",a+="</div>",e("#showPortletDropdown").live("click",function(){var t=[];t=i.setting.has_portlet(i);var a=0,s=[],n=1;for(var o in t[0]){var l={};l.id=100+a,l.pId=0,l.name=o,l.open=0==a,l.font={},s.push(l),e(t[0][""+o]).each(function(e){var i={};i.id=1e3*(a+1)+n,i.pId=100+a,i.name=t[0][""+o][e].name,i.portletID=t[0][""+o][e].id,i.repetition=t[0][""+o][e].repetition,l.font={},s.push(i),n++}),a++}var p={data:{simpleData:{enable:!0}},callback:{onClick:click_to_add_portlet},view:{fontCss:function(t,a){var i=data_portlet.portlets,s={};return""==a.portletID?s={color:"#a5a5a5"}:0==a.repetition&&e(i).each(function(t){e(i[t]).each(function(e){if(a.portletID===i[t][e].id)return s={color:"#a5a5a5"},!1})}),s},selectedMulti:!1}};e.fn.zTree.init(e("#tree_portletslist"),p,s)}),e("#add_portlets_ul .closeImg").off("click"),e("#add_portlets_ul").off("click"),e("#add_portlets_ul .closeImg").live("click",function(){e(this).closest(".spacePortlet").removeClass("open")}),e("#add_portlets_ul").live("click",function(){return!1}),i.putHtml(t,".space_top_nav>."+t+">.spacePortlet",a)},t.prototype.layout=function(t){var a="",i=this;a+="<div class='layout dropdown'><a href='javascript:void(0);' class='dropdown-toggle' data-toggle='dropdown'> 调整布局",a+="&nbsp;&nbsp;<span class='caret'></span></a>",a+='<ul class="dropdown-menu" role="menu" id="change_layout_ul"><li onclick="changeLayout(1)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat 0px 0px;"></div><input type="hidden" value="1"/><span><input type="radio" name="layoutId" class="ischeck"/>三列（1:2:1）</span></a></li><li onclick="changeLayout(2)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -120px 0px;"></div><input type="hidden" value="2"/><span><input type="radio" name="layoutId" class="ischeck"/>两列（2:1）</span></a></li><li onclick="changeLayout(3)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -240px 0px;"></div><input type="hidden" value="3"/><span><input type="radio" name="layoutId" class="ischeck"/>两列（1:2）</span></a></li><li onclick="changeLayout(4)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -360px 0px;"></div><input type="hidden" value="4"/><span><input type="radio" name="layoutId" class="ischeck"/>两列（1:1）</span></a></li><li onclick="changeLayout(5)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -480px 0px;"></div><input type="hidden" value="5"/><span><input type="radio" name="layoutId" class="ischeck"/>三列（1:1:1）</span></a></li><li onclick="changeLayout(6)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -600px 0px;"></div><input type="hidden" value="6"/><span><input type="radio" name="layoutId" class="ischeck"/>T列（1:1:1）</span></a></li><li onclick="changeLayout(7)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat 0px -120px;"></div><input type="hidden" value="7"/><span><input type="radio" name="layoutId" class="ischeck"/>T列（1:2）</span></a></li><li onclick="changeLayout(8)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -120px -120px;"></div><input type="hidden" value="8"/><span><input type="radio" name="layoutId" class="ischeck"/>T列（2:1）</span></a></li><li onclick="changeLayout(9)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -240px -120px;"></div><input type="hidden" value="9"/><span><input type="radio" name="layoutId" class="ischeck"/>T列（1:1）</span></a></li><li onclick="changeLayout(10)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -360px -120px;"></div><input type="hidden" value="10"/><span><input type="radio" name="layoutId" class="ischeck"/>TB列（1:1）</span></a></li><li onclick="changeLayout(11)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -480px -120px;"></div><input type="hidden" value="11"/><span><input type="radio" name="layoutId" class="ischeck"/>TB列（1:1:1）</span></a></li><li onclick="changeLayout(12)"><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/layout.png) no-repeat -600px -120px;"></div><input type="hidden" value="12"/><span><input type="radio" name="layoutId" class="ischeck"/>自由布局</span></a></li></ul>',a+="</div>",i.putHtml(t,".space_top_nav>."+t+">.layout",a),e("#space_common .layout").click(function(){e("#change_layout_ul li").eq(data_portlet.layout-1).find(".ischeck").attr("checked","checked")})},t.prototype.theme=function(t){var a="",i=this,s=i.getThemeId();a+="<div class='theme dropdown'><a href='javascript:void(0);' class='dropdown-toggle' data-toggle='dropdown'> 设置风格",a+="&nbsp;&nbsp;<span class='caret'></span></a>",i.personInfo.bidentity_id>=100&&i.personInfo.bidentity_id<105?a+='<ul class="dropdown-menu" role="menu" id="change_theme_ul"><li themeVal=\'teacher\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat 0px 0px;"></div><input type="hidden" value="teacher"/><span><input type="radio" name="themeId" class="ischeck"/>蓝色风格</span></a></li><li themeVal=\'student\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -120px 0px;"></div><input type="hidden" value="student"/><span><input type="radio" name="themeId" class="ischeck"/>红色风格</span></a></li><li themeVal=\'style3\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -240px 0px;"></div><input type="hidden"  value="style3"/><span><input type="radio" name="themeId" class="ischeck"/>橙色风格</span></a></li><li themeVal=\'style4\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -360px 0px;"></div><input type="hidden"  value="style4"/><span><input type="radio" name="themeId" class="ischeck"/>青色风格</span></a></li><li themeVal=\'style5\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -480px 0px;"></div><input type="hidden"  value="style5"/><span><input type="radio" name="themeId" class="ischeck"/>黄色风格</span></a></li><li themeVal=\'style6\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -600px 0px;"></div><input type="hidden"  value="style6"/><span><input type="radio" name="themeId" class="ischeck"/>暗色风格</span></a></li><li themeVal=\'style7\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat 0px -120px;"></div><input type="hidden"  value="style7"/><span><input type="radio" name="themeId" class="ischeck"/>浅绿风格</span></a></li><li themeVal=\'style8\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -120px -120px;"></div><input type="hidden"  value="style8"/><span><input type="radio" name="themeId" class="ischeck"/>金色风格</span></a></li><li themeVal=\'style9\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -240px -120px;"></div><input type="hidden"  value="style9"/><span><input type="radio" name="themeId" class="ischeck"/>米色风格</span></a></li><li themeVal=\'style10\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -360px -120px;"></div><input type="hidden"  value="style10"/><span><input type="radio" name="themeId" class="ischeck"/>粉色风格</span></a></li><li themeVal=\'style11\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -485px -120px;"></div><input type="hidden"  value="style11"/><span><input type="radio" name="themeId" class="ischeck"/>蓝灰风格</span></a></li><li themeVal=\'style12\'><a href="javascript:void(0);"><div style="width:121px;height:121px;background:url('+i.path+'/images/space/main/theme_org.png) no-repeat -615px -120px;"></div><input type="hidden"  value="style12"/><span><input type="radio" name="themeId" class="ischeck"/>彩色风格</span></a></li></ul>':a+='<div class="dropdown-menu spaceDropDownV2" role="menu" id="change_theme_ul_V2"><ul class="nav nav-tabs theme100" role="tablist"><li role="presentation" class="active"><a href="#oldTheme12" aria-controls="profile" role="tab" data-toggle="tab">实用风格</a></li><li role="presentation"><a href="#newTheme12" aria-controls="home" role="tab" data-toggle="tab">炫彩风格</a></li></ul><div class="theme100"><div class="tab-content leftTh"><div role="tabpanel" class="tab-pane active" id="oldTheme12"><div class="th_l"><div themeVal="oldTheme1" class="bigImg mr mb oldTheme1"><div class="checked"></div></div><div themeVal="oldTheme2" class="img mb oldTheme2"><div class="checked"></div></div><div themeVal="oldTheme3" class="img mb oldTheme3"><div class="checked"></div></div><div themeVal="oldTheme4" class="img mr oldTheme4"><div class="checked"></div></div><div themeVal="oldTheme5" class="img mr oldTheme5"><div class="checked"></div></div><div themeVal="oldTheme6" class="img oldTheme6"><div class="checked"></div></div></div><div class="th_r"><div themeVal="oldTheme7" class="img mr oldTheme7"><div class="checked"></div></div><div themeVal="oldTheme8" class="img mr oldTheme8"><div class="checked"></div></div><div themeVal="oldTheme10" class="img oldTheme9"><div class="checked"></div></div><div themeVal="oldTheme9" class="bigImg mr mt oldTheme10"><div class="checked"></div></div><div themeVal="oldTheme11" class="img mb mt oldTheme11"><div class="checked"></div></div><div themeVal="oldTheme12" class="img oldTheme12"><div class="checked"></div></div></div></div><div role="tabpanel" class="tab-pane" id="newTheme12"><div class="th_l"><div themeVal="teacher" class="bigImg mr mb teacher"><div class="checked"></div></div><div themeVal="student" class="img mb student"><div class="checked"></div></div><div themeVal="style3" class="img mb style3"><div class="checked"></div></div><div themeVal="style4" class="img mr style4"><div class="checked"></div></div><div themeVal="style5" class="img mr style5"><div class="checked"></div></div><div themeVal="style6" class="img style6"><div class="checked"></div></div></div><div class="th_r"><div themeVal="style7" class="img mr style7"><div class="checked"></div></div><div themeVal="style8" class="img mr style8"><div class="checked"></div></div><div themeVal="style9" class="img style9"><div class="checked"></div></div><div themeVal="style10" class="bigImg mr mt style10"><div class="checked"></div></div><div themeVal="style11" class="img mb mt style11"><div class="checked"></div></div><div themeVal="style12" class="img style12"><div class="checked"></div></div></div></div></div><div class="rightTh '+s+'"><div class="rightThBg"></div></div></div></div>',a+="</div>",e("#change_theme_ul_V2").off("click"),e("#change_theme_ul_V2").live("click",function(){return!1}),i.putHtml(t,".space_top_nav>."+t+">.theme",a),i.personInfo.bidentity_id>=100&&i.personInfo.bidentity_id<105?e("li[themeVal='"+s+"'] .ischeck").attr("checked",!0):e("div[themeVal='"+s+"'] .checked").addClass("active"),e(".space_top_nav").find(".theme [themeVal]").click(function(){var t=e(this).attr("themeVal");e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),theme_json:'{"theme":"'+t+'"}',person_id:i.personInfo.bperson_id,identity_id:i.personInfo.bidentity_id},url:url_path_action+"/space/setSpaceThemeInfo",dataType:"json",success:function(a){a.success?(i.themeId=t,i.setting.body&&(e("body").attr("themeVal",i.themeId),e("body").attr("themeType",i.personInfo.bidentity_id>=100&&i.personInfo.bidentity_id<105?"org":"person")),i.personInfo.bidentity_id>=100&&i.personInfo.bidentity_id<105?e("li[themeVal='"+t+"'] .ischeck").attr("checked",!0):(e("[themeVal] .checked").removeClass("active"),e("div[themeVal='"+t+"'] .checked").addClass("active"))):dialogOk("保存异常")},error:function(){dialogOk("保存异常")}})}),e("#change_theme_ul_V2 .nav a").click(function(t){return t.preventDefault(),e(this).tab("show"),e(this).closest(".dropdown").removeClass("active"),!1}),e("#change_theme_ul_V2 .tab-content .tab-pane>div>div").hover(function(){e("#change_theme_ul_V2 .theme100 .rightTh").attr("class","rightTh "+e(this).attr("themeVal"))},function(){e("#change_theme_ul_V2 .theme100 .rightTh").attr("class","rightTh "+i.themeId)})},t.prototype.open=function(e){var t="",a=this;a.personInfo.bidentity_id<100&&(t+="<div class='open'><a target='_blank' href='"+a.path+"/html/space/main/main.html?to_open=0'>公开空间预览</a>",t+="</div>"),a.putHtml(e,".space_top_nav>."+e+">.open",t)},t.prototype.manage=function(e){var t="",a=this;t+="<div class='manage'><a target='_blank' href='"+a.path+"/html/social/main_set/main_set.html?space_type=2&orgid="+a.personInfo.bperson_id+"&iid="+a.personInfo.bidentity_id+"'>空间管理</a>",t+="</div>",a.putHtml(e,".space_top_nav>."+e+">.manage",t)},t.prototype.select=function(t){var a="",i=this;a+="<div class='select dropdown'><div id='space_select_by_sort' class='dropdown-toggle' data-toggle='dropdown'><div class='sort'><div class='sort_select' data-value='5'><span>搜工作室</span></div></div><div class='select_input'><input class='select_input' type='text'/></div></div><div class='dropdown-menu select_info' role='menu'></div>",a+="</div>",i.putHtml(t,".space_top_nav>."+t+">.select",a),e(".space_top_nav .select").bind("click",function(){return!e(".space_top_nav .select").hasClass("open")&&(0!=e(".space_top_nav .select input").val().length&&void 0)});var s;e(".space_top_nav .select input").bind("mouseup keyup",function(){clearInterval(s),s=setInterval(function(){if(clearInterval(s),e(".space_top_nav .select .sort_select_val").hide(),0==e(".space_top_nav .select input").val().length)return!1;var t=e(".space_top_nav .select .sort_select").attr("data-value");i.spaceSelectFunction(t,1)},500)}),e(".space_top_nav .select .sort_select").click(function(){return e(".space_top_nav .select .sort_select_val").toggle(),!1}),e("body").click(function(){e(".space_top_nav .select .sort_select_val").hide()}),e(".space_top_nav .select .sort_select_val > div").click(function(){return e(".space_top_nav .select .sort_select").attr("data-value",e(this).attr("value")),e(".space_top_nav .select .sort_select > span").html(e(this).html()),e(".space_top_nav .select .sort_select_val").hide(),e(".space_top_nav .select input").trigger("mouseup"),!1})},t.prototype.spaceSelectFunction=function(t,a){e(".space_top_nav .select").hasClass("open")||e(".space_top_nav .select").addClass("open");var i="",s=0,n=0,o=this;i="<div class='select_list'>",e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),keyWord:Base64.encode(e(".space_top_nav .select input").val()),pageNumber:a,pageSize:5,group_type:2,plat_type:10},url:url_path_action_login+"/group/queryGroup",dataType:"json",success:function(e){if(e.success){s=e.rows.length,n=e.totalPage,0==e.rows.length?i+="<div style='width: 100%;height: 100px;line-height: 100px;text-align: center;'>未查询到数据</div>":i+="<div class='datalist'><div class='org'>群组名</div><div class='name'>创建者</div></div>";for(var t=0;t<e.rows.length;t++)i+="<div class='datalist' data-link='"+o.path+"/yx/html/space/main/work.html?orgid="+e.rows[t].ID+"&iid=106'><div class='org textEllipsis' title='"+e.rows[t].GROUP_NAME+"'>"+e.rows[t].GROUP_NAME+"</div><div class='name textEllipsis' title='"+e.rows[t].CREATOR_NAME+"'>"+e.rows[t].CREATOR_NAME+"</div></div>"}},error:function(){}}),s>0&&(i+="<div class='select_page'><div class='lgt'>",a>1&&(i+="<span data-page='"+(a-1)+"'><<</span>"),i+="</div><div class='mgt'>第"+a+"页 共"+n+"页</div><div class='rgt'>",a<n&&(i+="<span data-page='"+(a-0+1)+"'>>></span>"),i+="</div></div>"),i+="</div>",e(".space_top_nav .select .select_info").html(i),e(".space_top_nav .select .select_page span").bind("click",function(){o.spaceSelectFunction(t,e(this).attr("data-page"))}),e(".space_top_nav .select .select_info .datalist[data-link]").bind("click",function(){window.open(e(this).attr("data-link"))})},t.prototype.message=function(t){var a="",i=this;a+="<div class='message'><a href='javascript:void(0);'>消息<span class='msg_span'>0</span>",a+="</a>",a+="<div class='messages_box dropdown-menu' role='menu'>",e(".space_top_nav").off("click",".message"),e("#deleteAllshenqingMsgPage").live("click",function(){art.dialog({lock:!0,icon:"question",title:"提示",content:"确定清空消息吗？"},function(){e.ajax({type:"POST",async:!1,data:{random_num:creatRandomNum(),person_id:i.personInfo.person_id,identity_id:i.personInfo.identity_id},url:url_path_action+"/space/message/clear_message",dataType:"json",success:function(e){e.success?art.dialog({lock:!0,icon:"question",title:"提示",content:"已清理消息。",time:2,close:function(){i.spaceMessageArt.close()}}):art.dialog({lock:!0,icon:"question",title:"提示",content:"已清理消息。",time:2})},error:function(){art.dialog({lock:!0,icon:"question",title:"提示",content:"已清理消息。",time:2})}})},function(){})}),e(".space_top_nav").on("click",".message",function(){i.spaceMessageArt=art.dialog({width:800,height:460,lock:!0,icon:null,title:"消息",padding:"0 15px",init:function(){},close:function(){i.message("right")}}),i.getAllMessageList(1)}),a+="</div>",a+="</div>",i.putHtml(t,".space_top_nav>."+t+">.message",a),e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),person_id:i.personInfo.person_id,identity_id:i.personInfo.identity_id},url:url_path_action+"/space/message/get_prompt_message",dataType:"json",success:function(t){t.success&&e(".space_top_nav .message .msg_span").html(t.message_number)}})},t.prototype.getAllMessageList=function(t){var a=this,i={};i=a.getMessageList(t,10);var s="<div class='getAllshenqingMsg'>";e(i.list).each(function(e){s+="<div class='messagesa'>"+getSpaceDictionaryMessage(i.list[e])+"</div>"}),i.list.length>0||(s+="<div style='text-align: center;height: 200px;line-height: 200px;'>没有最新消息。</div>"),s+="<button type='button' class='btn btn-primary btn-sm' id='deleteAllshenqingMsgPage'>清空</button>",s+="<div id='allshenqingMsgPage'></div>",s+="</div>",a.spaceMessageArt.content(s),loadScripts(["/dsideal_yy/js/space/tools/spacePage.js"],0,function(){e("#allshenqingMsgPage").spacePage({pageSize:i.page_size,pageNumber:i.page_number,totalPage:i.total_page,totalRow:i.total_row,callBack:function(e){a.getAllMessageList(e)}})})},t.prototype.getMessageList=function(t,a){var i=this,s={};return e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),person_id:i.personInfo.person_id,identity_id:i.personInfo.identity_id,page_number:t,page_size:a},url:url_path_action+"/space/message/get_message",dataType:"json",success:function(e){e.success?(s=e).success=!0:(s.success=!1,s.list=[])},error:function(){s.success=!1,s.list=[]}}),s},t.prototype.person=function(t){var a="",i=this;a+="<div class='person dropdown'><a href='javascript:void(0);' class='dropdown-toggle' data-toggle='dropdown'>"+e.cookie("person_name"),a+="<span class='caret'></span></a>",a+="<ul id='dropdown_to_where' class='dropdown-menu' role='menu'>",1!=e.cookie("ydrz")&&(a+='<li><a href="javascript:doLogout();">退出</a></li>'),a+="</div>",i.putHtml(t,".space_top_nav>."+t+">.person",a)},t.prototype.viewSpace=function(e){var t,a="",i=this;a+="<div class='viewSpace dropdown' title='"+(t=i.personInfo.bidentity_id<100?Base64.decode(person_info_.space_name):Base64.decode(org_info_.org_name))+"'><a href='javascript:void(0);' class='dropdown-toggle' data-toggle='dropdown'>"+(t.length>8?t.substr(0,8)+"...":t),a+="&nbsp;&nbsp;<span class='back'><img src='../../../images/space/sec/location.png'/></span></a>",a+="</div>",i.putHtml(e,".space_top_nav>."+e+">.viewSpace",a)},t.prototype.login=function(t){var a="",i=this;a+="<div class='login'><a href='javascript:void(0);'>登录</a></div>",i.putHtml(t,".space_top_nav>."+t+">.login",a),e(i.ele).find(".space_top_nav>.right>.login").click(function(){art.dialog({content:'<form role="form" id="login_form"><div class="form-group"><h3>用户登录</h3></div><div class="form-group"><input placeholder="用户名" class="form-control" id="user" name="user" value="" onkeyup="value=value.replace(/[W]/g, \'\')" onbeforepaste="clipboardData.setData(\'text\',clipboardData.getData(\'text\').replace(/[W]/g, \'\')) " type="text"><ul id="per_ul" style="display: none;background: #ffffff;width:206px;" class="user-ul user-ulc"></ul></div><div class="form-group form-group-input"><input placeholder="密码" class="form-control" id="pwd" name="pwd" value="" onbeforepaste="clipboardData.setData(\'text\',clipboardData.getData(\'text\').replace(/[W]/g, \'\')) " type="password"></div><span id="log_error" class="pull-right" style="visibility: hidden; font-size:12px;color:red;margin-top:-15px;height: 30px;">&nbsp;</span><div class="form-group"><button type="button" class="btn bl space-btn-primary" onclick="javascript:doLogin();" style="font-weight:bold;font-size:15px !important;">登&nbsp;&nbsp;&nbsp;录</button></div></form>',width:300,lock:!0,zIndex:9999,title:"用户登录",style:"succeed noClose",init:function(){e("#pwd").keyup(function(e){13==e.keyCode&&(e.returnValue=!1,e.cancel=!0,doLogin())})}})})},t.prototype.getThemeId=function(){var t=this;return t.themeId?t.themeId:(e.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),person_id:t.personInfo.bperson_id,identity_id:t.personInfo.bidentity_id},url:url_path_action_login+"/space/getSpaceThemeInfo",dataType:"json",success:function(e){e.success?t.themeId=e.theme_json.theme:5==t.personInfo.bidentity_id?t.themeId="oldTheme9":6==t.personInfo.bidentity_id?t.themeId="oldTheme6":7==t.personInfo.bidentity_id?t.themeId="oldTheme12":t.themeId="teacher"},error:function(){t.themeId="teacher"}}),t.themeId)},t.prototype.putHtml=function(t,a,i){var s=this;e(s.ele).find(a).length?e(s.ele).find(a).replaceWith(i):e(s.ele).find("."+t).append(i)},e.fn.loadSpaceCommon=function(e){new t(this,e||{})},e.fn.loadSpaceCommon.constructor=t}(jQuery);
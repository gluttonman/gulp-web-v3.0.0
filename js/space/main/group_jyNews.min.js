function loadClassNews(t){var e=t||1;$.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),register_id:1000014,org_ids:org_id,notice_type:1,page_number:e,page_size:15},url:url_path_action_login+"/notice/getNoticeList",dataType:"json",success:function(t){if(t.success){(e={}).list=t.list,e.data=t,e.base64Encode=base64Encode,e.is_admin=is_admin,e.page_size=t.page_size,e.total_page=t.total_page,e.total_row=t.total_row,e.page_number=t.page_number;i=template("mainClassNewsInner",e);$("#mainClassNews").html(i)}else{var e={};e.list=[];var i=template("mainClassNewsInner",e);$("#mainClassNews").html(i)}},error:function(){var t={};t.list=[];var e=template("mainClassNewsInner",t);$("#mainClassNews").html(e)}})}function changeNoticeType(t){selectedNoticeType=t,loadClassNews()}function base64Encode(t){return Base64.decode(t)}function addNews(){var t;art.dialog({content:"<div id='addNews'><div class='row' style='margin:0px;width: 650px;line-height: 34px;'><div class='col-md-1' style='width:70px'>标题：</div><div class='col-md-11' style='width:400px'><input name='' class='form-control' id='news_title' placeholder='请输入新闻资讯标题' type='text' /><span class='help-block m-b-none'>新闻资讯标题<font color='red'>(必填，最多30个汉字，60个字符！)</font></span></div></div><div class='row' style='margin:0px;width: 600px;line-height: 34px;'><div class='col-md-1' style='width:70px'>内容：</div><div class='col-md-11' style='width:400px'><span class='help-block m-b-none' style='margin-top:0px;'>新闻资讯内容<font color='red'>(必填)</font></span></div></div><div class='row' style='margin:0px;line-height: 34px;'><div class='col-md-12'><script id='editor' type='text/plain'><\/script></div></div></div>",width:750,height:400,lock:!0,icon:null,title:"发布新闻资讯",init:function(){$("#news_id").val(""),t=UE.getEditor("editor",{toolbars:[tool_arr],initialFrameWidth:690,initialFrameHeight:300,zIndex:11111})},close:function(){t.destroy()}},function(){for(var e=$.trim($("#news_title").val()),i=0,n=0;n<e.length;n++)null!=e[n].match(/[^\x00-\xff]/gi)?i+=2:i+=1;if(0==i||i>60)return art.dialog.alert("标题请输入1-60个字符，1汉字=2字符！"),!1;if(!t.hasContents())return art.dialog.alert("请填新闻资讯内容！"),!1;var a=t.getContentTxt().substring(0,100);if(null==a||0==a.length)return art.dialog.alert("资讯内容不能只有图片！"),!1;$("#regist_id").val();var s=$("#news_title").val();return $.ajax({type:"POST",url:url_path_action+"/notice/addNotice",data:{register_id:1000014,title:s,content:t.getContent(),notice_type:1,org_id:org_id,org_type:orgidentity_id,person_id:$.cookie("person_id"),identity_id:$.cookie("identity_id")},dataType:"json",async:!1,success:function(t){t.success?dialogClose("操作成功！",3,200,"loadClassNews()"):art.dialog.alert(t.info)}}),!0},function(){})}function viewTheNews(t,e){e=e||"";art.dialog.open(t,{id:"setRole",lock:!0,title:e,width:"90%",height:"80%"})}function deleteNews(t,e,i){art.dialog.confirm("确定要删除 “"+i+"”?",function(){$.ajax({type:"GET",url:url_path_action+"/notice/deleteNoticeByIds?notice_ids="+t,dataType:"json",async:!1,success:function(t){t.success?dialogClose("删除成功！正在刷新列表...",3,220,"loadClassNews()"):art.dialog.alert(t.info)}})},function(){})}function editNews(t,e){$("#news_id").val(t);var i;art.dialog({content:"<div id='addNews'><div class='row' style='margin:0px;width: 650px;line-height: 34px;'><div class='col-md-1'>标题：</div><div class='col-md-11'><input name='' class='form-control' id='news_title' placeholder='请输入新闻资讯标题' type='text' /><span class='help-block m-b-none'>新闻资讯标题！<font color='red'>(必填，最多30个汉字，60个字符！)</font></span></div></div><div class='row' style='margin:0px;width: 600px;line-height: 34px;'><div class='col-md-1'>内容：</div><div class='col-md-11'><span class='help-block m-b-none' style='margin-top:0px;'>新闻资讯内容！<font color='red'>(必填)</font></span></div></div><div class='row' style='margin:0px;line-height: 34px;'><div class='col-md-12'><script id='editor' type='text/plain'><\/script></div></div></div>",width:750,height:400,lock:!0,icon:null,title:"发布新闻资讯",init:function(){(i=UE.getEditor("editor",{toolbars:[tool_arr],initialFrameWidth:690,initialFrameHeight:300,zIndex:11111})).ready(function(){i.setContent(getNewsById())})},close:function(){i.destroy()}},function(){for(var e=$.trim($("#news_title").val()),n=0,a=0;a<e.length;a++)null!=e[a].match(/[^\x00-\xff]/gi)?n+=2:n+=1;if(0==n||n>60)return art.dialog.alert("标题请输入1-60个字符，1汉字=2字符！"),!1;if(!i.hasContents())return art.dialog.alert("请填新闻资讯内容！"),!1;var s=i.getContentTxt().substring(0,100);if(null==s||0==s.length)return art.dialog.alert("请填新闻资讯内容！"),!1;var o=$("#news_title").val();return $.ajax({type:"POST",url:url_path_action+"/notice/editNotice",data:{notice_id:t,title:o,content:i.getContent()},dataType:"json",async:!1,success:function(t){t.success?dialogClose("操作成功！",1,200,"loadClassNews()"):art.dialog.alert(t.info)}}),!0},function(){})}function getNewsById(){$("#regist_id").val();var t=$("#news_id").val(),e="";return $.ajax({type:"GET",url:url_path_action_login+"/notice/getNoticeById?notice_id="+t,dataType:"json",async:!1,success:function(t){t.success?($("#news_title").val(t.notice.title),e+=t.notice.content):art.dialog.alert(t.info)}}),e}window.onload=function(){is_admin&&$("#add_news_btn").show(),loadClassNews()};
function getPersonSortList(t){var e={};$.ajax({type:"GET",async:!0,data:{random_num:creatRandomNum(),person_id:$.cookie("person_id"),identity_id:$.cookie("identity_id"),business_type:1,business_id:$.cookie("person_id"),business_iid:$.cookie("identity_id"),level:2},url:url_path_action+"/blog/getCategory",dataType:"json",success:function(i){if(i.success){e.list=i.list;var a=template("fenleiListInner",e);$("#per_sort").html(a),t&&t()}}})}function getOrgSortList(t){var e={};$.ajax({type:"GET",async:!0,data:{random_num:creatRandomNum(),business_type:1,business_id:1,level:1,identity_id:$.cookie("identity_id")},url:url_path_action+"/blog/getCategory",dataType:"json",success:function(i){if(i.success){e.list=i.list;var a=template("orgFenleiListInner",e);$("#org_sort").html(a),t&&t()}}})}function getArticleCategoryForManage(){$("#articleCategoryManageDialog table tbody").empty(),$.ajax({type:"GET",async:!1,data:{random_num:creatRandomNum(),person_id:$.cookie("person_id"),identity_id:$.cookie("identity_id"),business_type:1,business_id:$.cookie("person_id"),business_iid:$.cookie("identity_id"),level:2},url:url_path_action+"/blog/getCategory",dataType:"json",success:function(t){if(t.success){var e={};e.data=t;var i=template("articleCategoryManage_inner",e);$("#articleCategoryManageDialog table tbody").html(i);for(var a=0;a<t.list.length;a++)seq=t.list[a].sequence>seq?t.list[a].sequence:seq}},error:function(){var t={};t.success=!1,innerHtml.data=t;var e=template("articleCategoryManage_inner",innerHtml);$("#articleCategoryManageDialog table tbody").html(e)}})}function articleCategoryManage(t){getArticleCategoryForManage(),dia=art.dialog({content:$("#articleCategoryManageDialog").html(),width:700,lock:!0,icon:null,title:"分类管理",close:function(){2==t&&getPersonSortList()},ok:!0})}function editSortManage(t,e,i){var a=null;art.dialog({title:0==t?"增加分类":"修改分类",content:"<div id='editSortDiv' style='width:400px;'><table width='100%' class='table table-info'><tbody><tr><td scope='row' width='72'>分类名称<br/>&nbsp;</td><td colspan='3'><div id='editSortTitle'></div></tr></tbody></table></div>",fixed:!0,lock:!0,width:400,init:function(){a=$("#editSortTitle").input({index:3,placeholder:"请输入分类名称",maxCount:20,showType:1,width:275,onCheck:function(){""==a.input("value")&&a.input("setTips","分类名称不能为空")}}),1==t&&a.input("setVal",$(e).closest("tr").find(".title").html()),$("#editSortTitle").val($.trim($("#editSortTitle").val()).substring(0,20)),$("#editSortHid").text(20-$("#editSortTitle").val().length),$("#editSortTitle").bind("keyup",function(){$("#editSortTitle").val($.trim($("#editSortTitle").val()).substring(0,20)),$("#editSortHid").text(20-$("#editSortTitle").val().length)}).bind("paste",function(){$("#editSortTitle").val($.trim($("#editSortTitle").val()).substring(0,20)),$("#editSortHid").text(20-$("#editSortTitle").val().length)})}},function(){var e=a.input("value");return 0==e.length?(art.dialog.alert("请输入分类名称！"),!1):e.length>20?(art.dialog.alert("分类名称过长！"),!1):void(0==t?$.ajax({type:"POST",async:!1,data:{random_num:creatRandomNum(),name:e,sequence:seq+1,person_id:$.cookie("person_id"),identity_id:$.cookie("identity_id"),business_type:1,business_id:$.cookie("person_id"),business_iid:$.cookie("identity_id"),level:2,person_name:$.cookie("person_name")},url:url_path_action+"/blog/savePersonCategory",dataType:"json",success:function(t){t.success?(dialogClose("保存成功！",2,150,""),seq+=1,getArticleCategoryForManage(),dia.content($("#articleCategoryManageDialog").html())):dialogClose("保存失败！",2,150,"")},error:function(){dialogClose("保存失败！",2,150,"")}}):$.ajax({type:"POST",async:!1,data:{random_num:creatRandomNum(),name:e,id:i},url:url_path_action+"/blog/updatePersonCategory",dataType:"json",success:function(t){t.success?(dialogClose("修改成功！",2,150,""),getArticleCategoryForManage(),dia.content($("#articleCategoryManageDialog").html())):dialogClose("修改失败！",2,150,"")},error:function(){dialogClose("修改失败！",2,150,"")}}))},function(){})}function delSortManage(t,e){art.dialog({title:"删除分类",content:'确定删除"'+$(t).closest("tr").find(".title").html()+'"这个分类吗?',fixed:!0,lock:!0,icon:"question"},function(){$.ajax({type:"POST",async:!1,data:{random_num:creatRandomNum(),ids:e},url:url_path_action+"/blog/deletPersonCategoryByIds",dataType:"json",success:function(t){t.success?(dialogClose("删除成功！",2,150,""),getArticleCategoryForManage(),dia.content($("#articleCategoryManageDialog").html())):art.dialog.alert("删除失败！"+t.info)},error:function(){art.dialog.alert("删除失败！"+data.info)}})},function(){})}function moveSortManage(t,e){var i=$(t).closest("tr"),a=!1;if((0==e&&i.index()>0||1==e&&i.index()<i.siblings().length)&&(a=!0),a){var n=[];if(0==e){var o=i.find(".cid").val(),r=i.find(".cseq").val(),l=i.prev().find(".cid").val();n=[{category_id:o,sequence:s=i.prev().find(".cseq").val()},{category_id:l,sequence:r}]}else{var o=i.find(".cid").val(),r=i.find(".cseq").val(),l=i.next().find(".cid").val(),s=i.next().find(".cseq").val();n=[{category_id:o,sequence:s},{category_id:l,sequence:r}]}$.ajax({type:"POST",async:!1,data:{random_num:creatRandomNum(),category:JSON.stringify(n),org_person_id:$.cookie("person_id"),identity_id:$.cookie("identity_id")},url:url_path_action+"/blog/updateCategoryOrder",dataType:"json",success:function(t){t.success?(dialogClose("操作成功！",2,150,""),getArticleCategoryForManage(),dia.content($("#articleCategoryManageDialog").html())):dialogClose("操作失败！",2,150,"")},error:function(){dialogClose("操作失败！",2,150,"")}})}}function getArticleCategory(){var t={};$.ajax({type:"GET",async:!0,data:{random_num:creatRandomNum(),person_id:person_id,identity_id:identity_id,business_type:1,business_id:person_id,business_iid:identity_id,level:2},url:url_path_action_login+"/blog/getCategory",dataType:"json",success:function(e){t.data=e;var i=template("articleCategory_inner",t);$("#articleCategory").html(i),bindCategoryClick(),$("#articleCategory li").removeClass("active"),$("#category_"+cur_category).addClass("active")},error:function(){var e={};e.success=!1,t.data=e;var i=template("articleCategory_inner",t);$("#articleCategory").html(i)}})}function deleteArticle(t,e,i){var a=[{id:t,category_id:e}];art.dialog.confirm("确定要删除吗？",function(){var t=url_path_html+"/yx/article/delArticle?t="+Math.random();$.ajax({async:!0,url:t,type:"post",data:{ids:JSON.stringify(a)},dataType:"json",success:function(t){t.success?dialogClose("删除成功！",3,200,"toPage("+i+")"):dialogClose("系统繁忙，请稍后再试！",3,200,"")}})})}function deleteServiceArticle(t,e,i){art.dialog.confirm("确定要执行删除操作吗？",function(){if(!t||!e)return art.dialog.alert("id和expand_id不能为空"),!1;$.ajax({type:"post",url:url_path_html+"/yx/article/delArticleExpand",data:{id:t,expand_id:e},dataType:"json",success:function(t){t?(dialogClose("删除成功,正在刷新页面...",2,200),i&&setTimeout(function(){new Function(i)()},2e3)):art.dialog.alert("删除失败！")}})})}function viewDetail(t,e){var i=parent.window.location+"";i=i.substring(0,i.lastIndexOf("/")),window.open(i+"/article.html?id="+t+"&expand_id="+e)}var seq=0;